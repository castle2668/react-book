---
sidebar_position: 1
---

# Using Custom Hooks

> ğŸ’¡ å¯ä»¥ä½¿ç”¨ React Hooks èˆ‡ State çš„å‡½å¼
> ä½¿ç”¨æ™‚æ©Ÿï¼šç•¶ä¸åŒçµ„ä»¶è£¡æœ‰è‘—ä¸€å®šç¨‹åº¦å…±é€šçš„é‚è¼¯æ™‚ï¼Œæˆ‘å€‘æœƒæƒ³è¦è¤‡ç”¨å®ƒï¼Œè€Œåœ¨çµ„ä»¶ä¸­åªæ’°å¯«ä¸åŒçš„éƒ¨åˆ†ã€‚

## How to make Custom Hooks

Custom Hooks ä¸¦ä¸æ˜¯ Functional Componentsï¼Œä½†ä½œæ³•ä¸Šæœ‰äº›é¡ä¼¼ã€‚
é¦–å…ˆæˆ‘å€‘åœ¨ `src` ä¸‹å»ºç«‹ä¸€å€‹ `hooks` è³‡æ–™å¤¾ï¼Œç”¨ä¾†å­˜æ”¾ä¹‹å¾Œå»ºç«‹çš„ Custom Hooksã€‚æª”æ¡ˆå‘½åå‰‡æ˜¯ä¾ç…§å€‹äººå–œå¥½ï¼Œæˆ‘è‡ªå·±å–œæ­¡ç”¨ `use-xxx.js` ä½œç‚ºå‘½åè¦å‰‡ã€‚

æ–°å¢ `use-counter.js` æª”æ¡ˆï¼Œå»ºç«‹ä¸€å€‹å‡½å¼ `useCounter`ï¼Œæ³¨æ„æ­¤æ™‚ `useXXX` æ˜¯å¿…é ˆéµå®ˆçš„åç¨±è¦ç¯„ï¼Œé€™æ˜¯ç‚ºäº†èƒ½è®“ React è¾¨åˆ¥é€™æ˜¯ Custom Hooksã€‚

```jsx
import { useEffect, useState } from 'react';

const useCounter = () => {
  const [counter, setCounter] = useState(0);

  useEffect(() => {
    const interval = setInterval(() => {
      setCounter((prevCounter) => prevCounter + 1);
    }, 1000);

    return () => clearInterval(interval);
  }, []);

  return counter;
};

export default useCounter;
```

åœ¨ Custom Hooks ä¸­ä½¿ç”¨çš„ useState èˆ‡ useEffect æœƒèˆ‡ä½¿ç”¨å®ƒçš„çµ„ä»¶é€£çµï¼Œè€Œä¸”é‡é»æ˜¯ï¼Œå¦‚æœåœ¨**å¤šå€‹çµ„ä»¶**éƒ½ä½¿ç”¨äº†é€™å€‹ Custom Hookï¼Œå‰‡æ¯ä¸€å€‹çµ„ä»¶éƒ½æœƒç”¢ç”Ÿä¸€å¥—è‡ªå·±çš„ Custom Hookï¼Œä¹Ÿå°±æ˜¯è£¡é¢ä½¿ç”¨çš„ **State** æˆ– **Effect** ç­‰è³‡æ–™æ˜¯**ä¸æœƒå…±ç”¨**çš„ã€‚

å…±ç”¨çš„æ˜¯é‚è¼¯ï¼Œè€Œéç‹€æ…‹ï¼

æ¥è‘—å¦‚åŒå…§å»ºçš„ React Hooksï¼ŒCustom Hook ä¹Ÿè¦ `return` æ±è¥¿ï¼Œå¯ä»¥æ˜¯ä»»ä½•å‹åˆ¥ã€‚
æœ€å¾Œåœ¨çµ„ä»¶ä¸­ä½¿ç”¨ `useCounter` å–å¾—å›å‚³å€¼ï¼Œåˆ°é€™è£¡æˆ‘å€‘å°±å·²ç¶“æˆåŠŸå°‡é‚è¼¯æ‹†åˆ†å“©ã€‚

```jsx
const ForwardCounter = () => {
  const counter = useCounter();

  return <Card>{counter}</Card>;
};

export default ForwardCounter;
```

æ¥ä¸‹ä¾†æˆ‘å€‘é‡å°ä¸åŒçš„é‚è¼¯å»åšæ”¹è®Šï¼Œæ–¹æ³•æ˜¯é€éã€Œåƒæ•¸ã€ä¾†æŒ‡å®šä¸åŒçš„é‚è¼¯ã€‚
ä¾‹å¦‚ï¼šé€é `forwards` çµ¦äºˆ `false` è¡¨ç¤ºç‚ºéæ¸›ï¼Œé è¨­æˆ– `true` å‰‡ç‚ºéå¢ã€‚

```jsx
const useCounter = (forwards = true) => {
  const [counter, setCounter] = useState(0);

  useEffect(() => {
    const interval = setInterval(() => {
      // æ ¹æ“šåƒæ•¸çš„å€¼åˆ¤æ–·è¦åŸ·è¡Œçš„å‹•ä½œ
      if (forwards) {
        setCounter((prevCounter) => prevCounter + 1);
      } else {
        setCounter((prevCounter) => prevCounter - 1);
      }
    }, 1000);

    return () => clearInterval(interval);
  }, [forwards]); // Add parameter to the dependencies array

  return counter;
};
```

å‚³å…¥ `false` è¡¨ç¤ºè¦åŸ·è¡Œéæ¸›ã€‚

```jsx
const BackwardCounter = () => {
  const counter = useCounter(false);

  return <Card>{counter}</Card>;
};
```

## ä½¿ç”¨ Custom Hooks çš„æ³¨æ„äº‹é …

### 1. æ³¨æ„é‚£äº›å‚³åƒè€ƒçš„é¡åˆ¥

å¦‚æœ Custom Hook å›å‚³çš„å…§å®¹æœ‰å‡½å¼æˆ–ç‰©ä»¶ï¼Œåœ¨ä½¿ç”¨ useEffect æ™‚ä¸èƒ½å°‡å®ƒåŠ å…¥ dependencies array ä»¥åµæ¸¬ Function çš„æ”¹è®Šã€‚

ç‚ºä»€éº¼ï¼Ÿç…§ç†ä¾†èªªä¸æ˜¯è¦åŠ å…¥å—ï¼Ÿ
æ˜¯æ²’éŒ¯ï¼Œå¯æ˜¯åŠ å…¥å¾Œæœƒé€ æˆ Infinite Loopï¼å› ç‚ºæ¯æ¬¡æ–°ç”Ÿæˆçš„å‡½å¼ç‰©ä»¶é›–ç„¶å…§å®¹çœ‹ä¼¼ä¸€æ¨£ï¼Œä½†å…¶å¯¦å‚³çš„åƒè€ƒéƒ½ä¸åŒï¼Œé€™å°±æœƒé€ æˆ useEffect ä¸€ç›´é‡è·‘ã€‚

è§£æ±ºæ–¹æ³•ï¼šçµ¦äºˆå¯èƒ½è®Šå‹•çš„å‡½å¼æˆ–ç‰©ä»¶éƒ½å¥—ä¸Š useCallback æˆ– useMemoã€‚

### 2. å°‡å¤–éƒ¨ä¾è³´æ”¹ç‚ºå‡½å¼åƒæ•¸

é™¤äº†ç˜‹ç‹‚å¥—ç”¨ useCallback æˆ– useMemoï¼Œæˆ‘å€‘é‚„æœ‰å¦ä¸€å€‹æ›´å¥½çš„è¾¦æ³•ã€‚
é‚£å°±æ˜¯å°‡æ”¾åœ¨ Custom Hook èº«ä¸Šçš„ Dependencies æ”¹æ”¾åˆ°å…§å®¹è£¡é¢ï¼Œå…§å®¹å°±æ˜¯æŒ‡ Custom Hook ä¸­ç”¨åˆ°é€™äº›è®Šæ•¸çš„åœ°æ–¹ï¼Œåƒæ˜¯ã€Œç›´æ¥è®“è£¡é¢çš„ Function ä½¿ç”¨**åƒæ•¸**ã€ï¼Œé€™æ™‚å€™ Custom Hook å°±ä¸ç”¨æ–°å¢ä¾è³´äº†ã€‚

## å›é¡§

çœ‹å®Œé€™ç¯‡æ–‡ç« ï¼Œæˆ‘å€‘åˆ°åº•æœ‰ä»€éº¼æ”¶ç©«å‘¢ï¼Ÿè—‰ç”±æœ¬æ–‡å¯ä»¥ç†è§£åˆ°â€¦

- é€²éš JavaScript ç¨‹å¼è¨­è¨ˆä¸­éå¸¸é‡è¦çš„é–‰åŒ…çš„æ¦‚å¿µ
- è—‰ç”±é–‰åŒ…çš„ç¶“å…¸ç¯„ä¾‹ç­è§£é–‰åŒ…èˆ‡è‡ªç”±è®Šæ•¸çš„æ¦‚å¿µ
- ä½¿ç”¨ ES6 çš„ let è™•ç†é–‰åŒ…é€ æˆçš„æƒ…æ³
- åœ¨ ES5 ä½¿ç”¨ç«‹å³å‡½å¼è™•ç†é–‰åŒ…é€ æˆçš„æƒ…æ³

## References

- [JavaScript: Understanding the Weird Parts](https://www.udemy.com/course/understand-javascript/)
