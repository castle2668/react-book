---
sidebar_position: 2
---

# Introducing useReducer

## âš“ useReducer Hook

> ğŸ’¡ If you have an **object** as a state or a more **complex state updates**, useReducer might be interesting.

æ›´å¼·å¤§çš„ç‹€æ…‹ç®¡ç†ï¼Œä½†ä½¿ç”¨èµ·ä¾†ä¹Ÿæ›´ç‚ºè¤‡é›œï¼Œé©åˆç”¨æ–¼è³‡æ–™æœ‰è¼ƒè¤‡é›œçš„è™•ç†æ™‚ï¼Œä½†ä¸€èˆ¬è€Œè¨€ï¼Œå¤šæ•¸æƒ…æ³ä¸‹ä½¿ç”¨ useState å°±è¶³å¤ å“©ã€‚

å¦‚æœæœ‰å­¸é Vuexï¼Œå…¶å¯¦ useReducer æœ‰è‘—é¡ä¼¼ Vuex çš„è§€å¿µï¼Œä¸é useReducer æ²’è¾¦æ³•åƒ Vuex ä¸€æ¨£å»ºç«‹å…¨å±€çš„è³‡æ–™ç‹€æ…‹ï¼Œå®ƒå»ºç«‹çš„ä»ç„¶æ˜¯ç•¶å‰ Component çš„ State è€Œå·²ã€‚

### **ä½¿ç”¨æ–¹å¼** INIT (â‰ˆ State in Vuex)

```jsx
const [state, dispatchFn] = useReducer(reducerFn, initState, initFn);
```

- state: state snapshot
- **dispatchFn**: a function to update the state snapshot
- **reducerFn**: get the latest state snapshot automatically, and return the new updated state
- initState
- initFn

### Reducer Function (â‰ˆ Mutations in Vuex)

Reducer Function (reducerFn) å¯ä»¥ç›´æ¥ç”¨åŒ¿åç®­é ­å‡½å¼ï¼Œæˆ–æ˜¯é¡å¤–å¯«ä¸€å€‹å…·åå‡½å¼ã€‚å¦‚æœ Reducer Function æ²’æœ‰ç”¨åˆ° Component è£¡çš„ Stateï¼Œæ˜¯å¯ä»¥æŠŠå‡½å¼æ”¾åˆ° Component å¤–é¢çš„ã€‚

é€™å€‹ Reducer Function æœƒæ¥æ”¶å…©å€‹åƒæ•¸ï¼Œåˆ†åˆ¥æ˜¯ `state` èˆ‡ `action`ï¼Œä¸¦ä¸”æœ€å¾Œè¦ Return ä¸€å€‹æœ€æ–°çš„ Stateã€‚

```jsx
// State
const defaultEmailState = {
  value: '',
  isValid: false,
};
const emailReducer = (state, action) => {
  return defaultEmailState;
};

const Login = (props) => {
  const [emailState, dispatchEmail] = useReducer(
    emailReducer,
    defaultEmailState
  );
};
```

### Dispatch Function (â‰ˆ dispatch Actions in Vuex)

åœ¨å…ƒä»¶ä¸­ä½¿ç”¨ Dispatch Functionï¼Œå¾Œé¢å¸¶å…¥çš„åƒæ•¸æœƒä¸€èµ·å‚³éçµ¦ useReducer çš„ `action` åƒæ•¸ã€‚

ç¯„ä¾‹ä¸­ `emailReducer` å¯å–å¾—ç”± `dispatchEmail` æ‰€å‚³éçš„ `action.type` èˆ‡ `action.val`ã€‚

```jsx
//                     type       , payload
dispatchEmail({ type: 'USER_INPUT', val: event.target.value });
```

é€šå¸¸æˆ‘å€‘æœƒç”¨ã€Œç‰©ä»¶ã€çš„å½¢å¼ä¾†å®šç¾© `action`ï¼Œå› ç‚ºé€™æ¨£å¯ä»¥é †ä¾¿è²æ˜é€™å€‹ `action` çš„ `type`ã€‚

æ¥ä¸‹ä¾†æˆ‘å€‘å°±å¯ä»¥ä¾†æ›´æ–° state äº†ï¼

```jsx
// React guarantees that this state is absolutely the last state snapshot
const emailReducer = (state, action) => {
  // ä½¿ç”¨è€…è¼¸å…¥è§¸ç™¼ Dispatch Function
  if (action.type === 'USER_INPUT') {
    return { value: action.val, isValid: action.val.includes('@') };
  }
  // è¼¸å…¥æ¡†å¤±å»ç„¦é»è§¸ç™¼ Dispatch Function
  if (action.type === 'INPUT_BLUR') {
    return { value: state.value, isValid: state.value.includes('@') };
  }
  return { value: '', isValid: false };
};
```

## å›é¡§

çœ‹å®Œé€™ç¯‡æ–‡ç« ï¼Œæˆ‘å€‘åˆ°åº•æœ‰ä»€éº¼æ”¶ç©«å‘¢ï¼Ÿè—‰ç”±æœ¬æ–‡å¯ä»¥ç†è§£åˆ°â€¦

- é€²éš JavaScript ç¨‹å¼è¨­è¨ˆä¸­éå¸¸é‡è¦çš„é–‰åŒ…çš„æ¦‚å¿µ
- è—‰ç”±é–‰åŒ…çš„ç¶“å…¸ç¯„ä¾‹ç­è§£é–‰åŒ…èˆ‡è‡ªç”±è®Šæ•¸çš„æ¦‚å¿µ
- ä½¿ç”¨ ES6 çš„ let è™•ç†é–‰åŒ…é€ æˆçš„æƒ…æ³
- åœ¨ ES5 ä½¿ç”¨ç«‹å³å‡½å¼è™•ç†é–‰åŒ…é€ æˆçš„æƒ…æ³

## References

- [JavaScript: Understanding the Weird Parts](https://www.udemy.com/course/understand-javascript/)
